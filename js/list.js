"use strict";var flag1=flag2=flag3=flag4=0,origin=document.URL.match(/page=\d/g).join().match(/\d/).join()-1,way=void 0,key_word=void 0,page_=0;function sortDate(e){var a=e.length%12,t=void 0;console.log(a),0<a&&(t=$(".page_turner_active").text(),$(".fenye>#page").each(function(){$(this).text()>t&&$(this).css("visibility","hidden")})),console.log("max_l="+t);var o="";console.log(e),e.forEach(function(e){o+='\n                <li class="thumbnail" index="'+e.goods_id+'">\n                    <img src="'+e.listimg+'" alt="...">\n                    <div class="caption">\n                        <h3 class="theme">'+e.goods_name+'</h3>\n                        <p class="price">￥'+e.price+"</p>\n                    </div>\n                </li>\n                "}),0==e.length&&(console.log($(".fenye>#page")[2]),o="没有更多商品了"),$("#goodsContain").html(o)}function reader(e,a,t){a=(a=getCookie("login")?localStorage.getItem("way"):"fun1")||"fun1",t=localStorage.getItem("key_word"),e=e||0,history.replaceState(null,"列表页","./list.html?page="+(+e+1));e=document.URL.match(/page=\d/g).join().match(/\d/).join()-1;$(document).ajaxStart(function(){console.log("开始请求数据"),$(".loading").show()}).ajaxStop(function(){$(".loading").hide(),console.log("请求数据完成")}),console.log(e,a,t),$.ajax({url:"../api/list.php",type:"get",data:{way:a,num:e,key_word:t||""},dataType:"json",success:function(e){sortDate(e)},error:function(e){console.log(e)}})}$(".fenye").on("click",">a",function(){if(!getCookie("login"))return alert("请先登录!");$(this).addClass("page_turner_active").siblings().removeClass("page_turner_active");var e=$(this).html();$("html").finish().animate({scrollTop:0},300),reader(e-1,way,key_word)}),$("#prev").click(function(){if(!getCookie("login"))return alert("请先登录!");var e=document.URL.match(/page=\d/g).join().match(/\d/).join()-1,e=--e<=0?0:e;$(".fenye>a").eq(e).addClass("page_turner_active").siblings().removeClass("page_turner_active"),reader(e,way,key_word),$("html").finish().animate({scrollTop:0},300)}),$("#next").click(function(){if(!getCookie("login"))return alert("请先登录!");var e=document.URL.match(/page=\d/g).join().match(/\d/).join()-1;e++;var a=$(".fenye>a").length-1;console.log(a),e=a<=e?a:e,$(".fenye>a").eq(e).addClass("page_turner_active").siblings().removeClass("page_turner_active"),reader(e,way,key_word),$("html").finish().animate({scrollTop:0},300)}),$(".row").on("click",".thumbnail",function(){if(!getCookie("login"))return alert("请先登录!");var e=$(this).attr("index");localStorage.setItem("gid",e),location.href="./details.html?id="+e}),$(".sort_board .sort_item").click(function(){var e=void 0,e=getCookie("login")?$(this).index():0;localStorage.setItem("index",e),0==$(this).index()&&(flag1=0==flag1?(selectWay("fun2"),1):(selectWay("fun1"),0)),1==$(this).index()&&(flag2=0==flag2?(selectWay("fun3"),1):(selectWay("fun4"),0)),2==$(this).index()&&(flag3=0==flag3?(selectWay("fun5"),1):(selectWay("fun6"),0)),3==$(this).index()&&(flag4=0==flag4?(selectWay("fun7"),1):(selectWay("fun8"),0))});var _wr=function(t){var o=history[t];return function(){var e=o.apply(this,arguments),a=new Event(t);return a.arguments=arguments,window.dispatchEvent(a),e}};function selectWay(e){getCookie("login")||(e="fun1"),localStorage.setItem("way",e),reader(0,way=localStorage.getItem("way"))}history.replaceState=_wr("replaceState"),window.addEventListener("replaceState",function(e){var a=document.URL.match(/page=\d/g).join().match(/\d/).join()-1;$(".fenye>a").eq(a).addClass("page_turner_active").siblings().removeClass("page_turner_active");a=(a=localStorage.getItem("index"))||0;$(".sort_board .sort_item").eq(a).addClass("sort_active").siblings().removeClass("sort_active")}),window.onload=function(){var e=document.URL.match(/page=\d/g).join().match(/\d/).join()-1;$(".fenye>a").eq(e).addClass("page_turner_active").siblings().removeClass("page_turner_active");e=(e=localStorage.getItem("index"))||0;$(".sort_board .sort_item").eq(e).addClass("sort_active").siblings().removeClass("sort_active"),"fun9"==localStorage.getItem("way")&&$("#isHad").attr("checked","true"),"fun10"==localStorage.getItem("way")&&reader(0,localStorage.getItem("way"),key_word),"fun11"==localStorage.getItem("way")?reader(0,localStorage.getItem("way"),key_word):reader(origin,way)},$(".go_index").click(function(){location.href="./index.html"}),$("#isHad").click(function(){$("#isHad").is(":checked")?(localStorage.setItem("way","fun9"),reader(0,"fun9")):(localStorage.setItem("way","fun1"),reader(0,"fun1")),location.reload()});