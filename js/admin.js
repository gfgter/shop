"use strict";var p=function(s,n,i){return new Promise(function(o){$.ajax({url:"../api/login.php",type:"get",data:{way:s,user_name:n,user_pwd:i},dataType:"json",success:function(s){s.id?(setCookie("admin",!0,60),$("#loginbox").hide()):alert(s.msg),o(s)},error:function(s){console.log(s)}})})};function fun(){$("#menu").on("click",">li",function(){$(this).addClass("menu_active").siblings().removeClass("menu_active");var s=$(this).index();$(".nav>li").eq(s).addClass("nav_li_active").siblings().removeClass("nav_li_active"),$("#contains_>li").eq(s).addClass("history_active").siblings().removeClass("history_active")})}function delUser(){$(".del-user").click(function(){console.log($(this));var s=$(this).attr("userID");console.log(s),confirm("确认删除吗？")&&user_oprate("delUser",0,s).then(function(s){console.log(s)})})}function delGoods(){$(".g_del").click(function(){console.log($(this));var s=$(this).attr("goodsID");console.log(s),confirm("确认删除吗？")&&goods_oprate("delGoods","",s).then(function(s){console.log(s),delGoods()})})}function user(){return new Promise(function(n){$.ajax({url:"../api/login.php",type:"get",data:{way:"getUser"},dataType:"json",success:function(s){console.log(s);var o="";s.forEach(function(s){o+='\n                <div class="user-item">\n                <p>用户名:&nbsp;&nbsp;<span>'+s.user_name+"</span></p>\n                <p>权限类型:&nbsp;&nbsp;<span>"+(1==s.root?"管理员":"普通用户")+'</span></p>\n                <p><a class="del-user" userID="'+s.user_id+'">删除</a></p>\n                </div>\n                '}),$("#userBox").html(o),delUser(),n(s)},error:function(s){console.log(s)}})})}function goods(){return new Promise(function(n){$.ajax({url:"../api/goods.php",type:"get",data:{way:"getGoods"},dataType:"json",success:function(s){console.log(s);var o='\n                <div class="info">\n                    <div class="_1">ID</div>\n                    <div class="_2">小图</div>\n                    <div class="_3">名称/类型</div>\n                    <div class="_4">已售</div>\n                    <div class="_5">库存</div>\n                    <div class="_6">操作</div>\n                </div>\n                ';s.forEach(function(s){o+='\n                    <div class="goods-item">\n                    <div class="goods_ID">'+s.goods_id+'</div>\n                    <div class="goods_Pic">\n                        <img src="'+s.listimg+'" alt="">\n                    </div>\n                    <div class="goods_Name">\n                        <p class="g_name_">'+s.goods_name+'</p>\n                        <p class="g_sort_">服饰-'+s.sort2+'</p>\n                    </div>\n                    <div class="goods_Sale">'+s.hadsale+'</div>\n                    <div class="goods_Left">'+s.leftcount+'</div>\n                    <div class="goods_Del">\n                        <a class="g_del" goodsID="'+s.goods_id+'">删除</a>\n                    </div>\n                </div>\n                    '}),$("#goodsBox").html(o),delGoods(),n(s)},error:function(s){console.log(s)}})})}function order(){return new Promise(function(n){$.ajax({url:"../api/goods.php",type:"get",data:{way:"history"},dataType:"json",success:function(s){console.log(s);var o='\n                <div class="info">\n                    <div class="_1">ID</div>\n                    <div class="_2">小图</div>\n                    <div class="_3">名称/类型</div>\n                    <div class="_4">数量</div>\n                    <div class="_5">用户名</div>\n                    <div class="_6">状态</div>\n                </div>\n                ';s.forEach(function(s){o+='\n                    <div class="history-item">\n                    <div class="goods_ID">'+s.goods_id+'</div>\n                    <div class="goods_Pic">\n                        <img src="'+s.goods_pic+'" alt="">\n                    </div>\n                    <div class="goods_Name">\n                        <p class="g_name_">'+s.goods_name+'</p>\n                        <p class="g_sort_">服饰-'+s.sort2+'</p>\n                    </div>\n                    <div class="goods_Sale">'+s.count+'</div>\n                    <div class="goods_Left">'+s.name+'</div>\n                    <div class="goods_Del">\n                        交易完成\n                    </div>\n                </div>\n                    '}),$("#orderBox").html(o),n(s)},error:function(s){console.log(s)}})})}function user_oprate(s,o,i){return new Promise(function(n){$.ajax({url:"../api/login.php",type:"get",data:{way:s,keyword:o||"",userID:i||0},dataType:"json",success:function(s){var o;console.log(s),0==s.code?$("#userBox").html(s.msg):(o="",s.forEach(function(s){o+='\n                    <div class="user-item">\n                    <p>用户名:&nbsp;&nbsp;<span>'+s.user_name+"</span></p>\n                    <p>权限类型:&nbsp;&nbsp;<span>"+(1==s.root?"管理员":"普通用户")+'</span></p>\n                    <p><a class="del-user" userID="'+s.user_id+'">删除</a></p>\n                    </div>\n                    '}),$("#userBox").html(o)),delUser(),n(s)},error:function(s){console.log(s)}})})}function goods_oprate(s,o,i){return new Promise(function(n){$.ajax({url:"../api/goods.php",type:"get",data:{way:s,keyword:o||"",goodsID:i||0},dataType:"json",success:function(s){var o;console.log(s),0==s.code?$("#goodsBox").html(s.msg):(o='\n                <div class="info">\n                    <div class="_1">ID</div>\n                    <div class="_2">小图</div>\n                    <div class="_3">名称/类型</div>\n                    <div class="_4">已售</div>\n                    <div class="_5">库存</div>\n                    <div class="_6">操作</div>\n                </div>\n                ',s.forEach(function(s){o+='\n                    <div class="goods-item">\n                    <div class="goods_ID">'+s.goods_id+'</div>\n                    <div class="goods_Pic">\n                        <img src="'+s.listimg+'" alt="">\n                    </div>\n                    <div class="goods_Name">\n                        <p class="g_name_">'+s.goods_name+'</p>\n                        <p class="g_sort_">服饰-'+s.sort2+'</p>\n                    </div>\n                    <div class="goods_Sale">'+s.hadsale+'</div>\n                    <div class="goods_Left">'+s.leftcount+'</div>\n                    <div class="goods_Del">\n                        <a class="g_del" goodsID="'+s.goods_id+'">删除</a>\n                    </div>\n                </div>\n                    '}),$("#goodsBox").html(o)),delUser(),n(s)},error:function(s){console.log(s)}})})}function goods_add(s,o,i,d,a,e,c,l,t,r,v,g,u){return new Promise(function(n){$.ajax({url:"../api/goods.php",type:"get",data:{way:s,goodsID:o,goodsName:i,img1:d,img2:a,img3:e,img4:c,img5:l,price:t,hadsale:r,leftcount:v,listimg:g,sort2:u},dataType:"json",success:function(s){var o;console.log(s),0==s.code?$("#goodsBox").html(s.msg):(o='\n                <div class="info">\n                    <div class="_1">ID</div>\n                    <div class="_2">小图</div>\n                    <div class="_3">名称/类型</div>\n                    <div class="_4">已售</div>\n                    <div class="_5">库存</div>\n                    <div class="_6">操作</div>\n                </div>\n                ',s.forEach(function(s){o+='\n                    <div class="goods-item">\n                    <div class="goods_ID">'+s.goods_id+'</div>\n                    <div class="goods_Pic">\n                        <img src="'+s.listimg+'" alt="">\n                    </div>\n                    <div class="goods_Name">\n                        <p class="g_name_">'+s.goods_name+'</p>\n                        <p class="g_sort_">服饰-'+s.sort2+'</p>\n                    </div>\n                    <div class="goods_Sale">'+s.hadsale+'</div>\n                    <div class="goods_Left">'+s.leftcount+'</div>\n                    <div class="goods_Del">\n                        <a class="g_del" goodsID="'+s.goods_id+'">删除</a>\n                    </div>\n                </div>\n                    '}),$("#goodsBox").html(o)),delUser(),n(s)},error:function(s){console.log(s)}})})}window.onload=function(){getCookie("admin")?($("#loginbox").hide(),$("#menu").show(),$(".nav").show(),$("#contains_").show(),user()):(console.log(111),$("#loginbox").show()),$("#login").click(function(){var s=$("#admin").val(),o=$("#password").val();console.log(s,o),p("admin",s,o).then(function(s){console.log(s),1==s.code&&($("#menu").show(),$(".nav").show(),$("#contains_").show(),user(),fun())})})},fun(),$("#userAdmin").click(function(){user()}),$("#goodsAdmin").click(function(){goods()}),$("#orderAdmin").click(function(){order()}),$(".uSearch").click(function(){console.log($(this)),user_oprate("selectUser",$(".txt").val())}),$(".gSearch").click(function(){console.log($(this));var s=$(".txt").eq(1).val();console.log(s),goods_oprate("selectGoods",s).then(function(s){console.log(s)})}),$(".gAdd").click(function(){console.log($(this)),$("#add_g").show()}),$("#_close").click(function(){$("#add_g").hide()}),$("._add").click(function(){var n=!0,i=[];i.length=12,$(".g_val_").each(function(s,o){i[s]=o.value,""==o.value&&(n=!1)}),console.log(i),console.log(n),n?goods_add("addGoods",i[0],i[1],i[2],i[3],i[4],i[5],i[6],i[7],i[8],i[9],i[10],i[11]).then(function(s){console.log("success"),$("#add_g").hide(),$(".g_val_").each(function(s,o){o.value}),alert("添加成功")}).then(function(s){delGoods()}):alert("所有信息不能为空")});