"use strict";function reader(){return new Promise(function(s){var i=(i=localStorage.getItem("gid"))||18405;$.ajax({url:"../api/details.php",type:"get",data:{uid:i},dataType:"json",success:function(i){goodStructure(i),s()},error:function(i){console.log(i)}})})}function goodStructure(i){i='\n<div class="state">\n<a>商城首页>'+i.sort1+">"+i.sort2+">"+i.goods_name+'</a>\n</div>\n<div class="goods_about">\n<div class="zoom">\n<div class="showPic">\n    <img src="'+i.img1+'" alt="">\n    <div id="masker"></div>\n</div>\n<ul class="smallPic">\n    <li class="smallPic_item smallPic_active">\n        <a class="s_show"><img src="'+i.img1+'" alt=""></a>\n    </li>\n    <li class="smallPic_item">\n        <a class="s_show"><img src="'+i.img2+'" alt=""></a>\n    </li>\n    <li class="smallPic_item">\n        <a class="s_show"><img src="'+i.img3+'" alt=""></a>\n    </li>\n    <li class="smallPic_item">\n        <a class="s_show"><img src="'+i.img4+'" alt=""></a>\n    </li>\n    <li class="smallPic_item">\n        <a class="s_show"><img src="'+i.img5+'" alt=""></a>\n    </li>\n</ul>\n</div>\n<div class="goods_msg">\n<h3 id="title">'+i.goods_name+'</h3>\n<div class="priceBox">全款&ensp;\n    <i>￥</i>\n    <span id="price">'+i.price+'</span></div>\n<div class="saleBox">\n    <p id="hadsale_num">已售:&ensp; '+i.hadsale+'</p>\n    <p id="hadcomments">累计评论:&ensp;0</p>\n</div>\n<div class="sizeBox">\n    尺寸&ensp;\n    <a class="size_active">XS</a>\n    <a>S</a>\n    <a>M</a>\n    <a>L</a>\n    <a>XL</a>\n</div>\n<div class="goods_num_box ">\n    数量&ensp;\n    <div>\n        <a id="reduce">-</a>\n        <input type="text" id="goods_num" value="1">\n        <a id="add">+</a>\n    </div>\n</div>\n<div class="leave_num">(还剩'+i.leftcount+'件)\n</div>\n<div class="btnBox">\n    <button id="buy">立即购买</button>\n    <button id="addTo_cart">加入购物车</button>\n</div>\n</div>\n<div id="zoom">\n</div>\n</div>\n\n<div id="details" class="clearFix">\n<ul class="details_tab">\n<li class="details_tab_active">商品详情</li>\n<li>用户点评(0)</li>\n<li>联系商家</li>\n</ul>\n<ul class="picDetails">\n<li id="goods_pic_details">\n    <ul class="goods_describe">\n        <li>商品名称:&nbsp;'+i.goods_name+"</li>\n        <li>店铺:&nbsp;官方商城</li>\n        <li>上架时间:&nbsp;"+i.launch_time+"</li>\n        <li>商品毛重:&nbsp;1g</li>\n        <li>商城:&nbsp;王者荣耀</li>\n        <li>周边分类:&nbsp;"+i.sort1+"/"+i.sort2+'</li>\n    </ul>\n    <div id="details_pic">\n        '+i.details+'\n    </div>\n</li>\n<li id="goods_comments_details">\n    <p>玩家综合评分: <span></span><i>0.0</i> </p>\n</li>\n<li id="goods_saler_details">\n    <p>商家 QQ: 123</p>\n    <p>商家电话: 123</p>\n    <p>商家微信: 123</p>\n    <p>服务时间: '+i.merchant_online_data+"</p>\n    <p></p>\n</li>\n</ul>\n</div>\n";$("#contains").html(i)}(void 0).reader().then(function(){var i=localStorage.getItem("userName"),s=localStorage.getItem("userID"),a=localStorage.getItem("gid"),n=document.URL.match(/id=\d+/).join().match(/\d+/).join();function l(i,s,a,n){var l=$(".leave_num").text().match(/\d+/).join();if(null!=getCookie("login")){if(l<=0)return alert("库存不足,请挑选其他商品");l=$("#goods_num").val(),$.ajax({url:"../api/car.php",type:"get",data:{way:"fun1",userName:i,userID:s,goodsID:a,buy_num:l},dataType:"json",async:!0,success:function(i){console.log(i),2==n?(alert(i.msg),location.reload()):1==n&&(location.href="./car.html")},error:function(i){console.log(i)}})}else alert("请登录!")}a=a||n,$(document).ready(function(){var i=$(".showPic>img").eq(0).attr("src");$("#zoom").css("background-image","url("+i+")")}),$(".smallPic").on("click",".smallPic_item",function(){$(this).addClass("smallPic_active").siblings().removeClass("smallPic_active");var i=$(this).find("img").attr("src");$(".showPic>img").attr("src",i),$("#zoom").css("background-image","url("+i+")")}),$(".showPic").mouseover(function(i){$("#masker").show(),$("#zoom").show()}),$(".showPic").mousemove(function(i){var s=i.pageX-$("#masker").width()/2,a=i.pageY-$("#masker").height()/2,n=$(".showPic").offset().left+1,l=$(".showPic").offset().top+1,o=$(".showPic").width()+n-$("#masker").width(),i=$(".showPic").height()+l-$("#masker").height();s=o<=(s=s<=n?n:s)?o:s,a=i<=(a=a<=l?l:a)?i:a,$("#masker").offset({top:a,left:s});a=-690*parseFloat($("#masker").css("left"))/458,s=-660*parseFloat($("#masker").css("top"))/438;$("#zoom").css("background-position",a+"px "+s+"px")}),$(".showPic").mouseout(function(){$("#masker").hide(),$("#zoom").hide()}),$(".sizeBox>a").click(function(){$(this).addClass("size_active").siblings().removeClass("size_active")}),$("#reduce").click(function(){var i=$(".leave_num").text().match(/\d+/),s=+$("#goods_num").val();if(0==i)return $("#goods_num").val(0);s=--s<=1?1:s,$("#goods_num").val(s)}),$("#add").click(function(){var i=+$("#goods_num").val(),s=$(".leave_num").text().match(/\d+/),i=s<=++i?s:i;$("#goods_num").val(i)}),$("#goods_num").change(function(){var i=+$("#goods_num").val(),s=$(".leave_num").text().match(/\d+/);if(-1<i)return 0==s?$(this).val(0):1<i&&i<=s?$(this).val(i):i<=1?$(this).val(1):$(this).val(s);s=0<s?$(this).val(1):$(this).val(0)}),$("#buy").click(function(){l(i,s,a,1),console.log(a,i,s)}),$("#addTo_cart").click(function(){l(i,s,a,2),console.log(a,i,s)}),$(".details_tab").on("click","li",function(){$(this).addClass("details_tab_active").siblings().removeClass("details_tab_active");var i=$(this).index();$(".picDetails>li").eq(i).show().siblings().hide()})});